# SELinux status
r_dir_file(system_app, selinuxfs)

# ExtendedSettings props
r_dir_rw_file(system_app, sysfs_graphics)
r_dir_rw_file(system_app, sysfs_pcc_profile)
set_prop(system_app, adbtcpes_prop)
set_prop(system_app, dispcal_prop)

# Needed by system "main" and others
# Different system_apps need this, independent from timekeep.c or
# TimeKeep.java, so keep it in here
# avc: granted { read } for comm="main" name="u:object_r:timekeep_prop:s0" dev="tmpfs" ino=13587 scontext=u:r:system_app:s0 tcontext=u:object_r:timekeep_prop:s0 tclass=file
set_prop(system_app, timekeep_prop)

# For android setttings
binder_call(system_app, per_mgr)
binder_call(system_app, wificond)

# TODO: Find out which system_apps are using these
allow system_app fs_bpf:dir search;
allow system_app proc_pagetypeinfo:file read;
allow system_app sysfs_zram:dir search;
userdebug_or_eng(`
  auditallow system_app fs_bpf:dir search;
  auditallow system_app proc_pagetypeinfo:file read;
  auditallow system_app sysfs_zram:dir search;
')
