# SELinux status
r_dir_file(system_app, selinuxfs)

# ExtendedSettings props
r_dir_rw_file(system_app, sysfs_graphics)
r_dir_rw_file(system_app, sysfs_pcc_profile)
set_prop(system_app, adbtcpes_prop)
set_prop(system_app, dispcal_prop)

# Different system_apps read this value, independent from timekeep.c or
# TimeKeep.java, so keep it in here
set_prop(system_app, timekeep_prop)

# For android setttings
binder_call(system_app, per_mgr)
binder_call(system_app, wificond)

# avc: denied { call } for comm=4173796E635461736B202331 scontext=u:r:system_app:s0 tcontext=u:r:storaged:s0 tclass=binder
# -> storaged is not a public or vendor type, only private can access it.
# The dontaudit below also does not work because storaged is not in public
# ERROR 'unknown type storaged
#dontaudit system_app storaged:binder call;
# TODO: Is this needed?
# Allow system_apps to at least find the storage manager:
# -> doesn't seem so, but test on tama please
#allow system_app storaged_service:service_manager find;
#userdebug_or_eng(`
#  auditallow system_app storaged_service:service_manager find;
#')

# This is a neverallow anyways, so ignore it
dontaudit system_app perfprofd:binder call;

allow system_app fs_bpf:dir search;
allow system_app proc_pagetypeinfo:file r_file_perms;
allow system_app sysfs_zram:dir search;
allow system_app sysfs_zram:file r_file_perms;
