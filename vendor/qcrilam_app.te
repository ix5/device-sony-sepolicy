# TODO: All of this is probably(?) unused since com.sony.qcrilam
# just gets executed as a system_app

# ???????????????????????????????????????
# ???????????????????????????????????????
# ???????????????????????????????????????
# ???????????????????????????????????????
# ???????????????????????????????????????
# ???????????????????????????????????????
# ???????????????????????????????????????

type qcrilam_app, domain;

# TODO: Is this necessary?
typeattribute qcrilam_app binder_in_vendor_violators;

app_domain(qcrilam_app)

# TODO: Neat idea? from private/system_app.te
binder_service(qcrilam_app)

add_service(qcrilam_app, qcrilam_service)
auditallow qcrilam_app qcrilam_service:service_manager { add find };

binder_use(qcrilam_app)
auditallow qcrilam_app servicemanager:binder { call transfer };

allow qcrilam_app vnd_qcril_audio_hwservice:hwservice_manager { find };
auditallow qcrilam_app vnd_qcril_audio_hwservice:hwservice_manager { find };

binder_call(qcrilam_app, vnd_qcril_audio_hwservice)
auditallow qcrilam_app vnd_qcril_audio_hwservice:binder { call transfer };
auditallow vnd_qcril_audio_hwservice qcrilam_app:binder { transfer };

binder_call(qcrilam_app, rild)
auditallow qcrilam_app rild:binder { call transfer };
auditallow rild qcrilam_app:binder { transfer };

binder_call(qcrilam_app, per_mgr)
auditallow qcrilam_app per_mgr:binder { call transfer };
auditallow per_mgr qcrilam_app:binder { transfer };
