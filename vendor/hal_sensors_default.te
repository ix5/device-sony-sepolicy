# interact with the sensors low power island (SLPI) CPU
allow hal_sensors_default self:socket { create ioctl read write };
allowxperm hal_sensors_default self:socket ioctl msm_sock_ipc_ioctls;

r_dir_file(hal_sensors_default, sysfs_msm_subsys);
# avc: denied { open } for comm="android.hardwar" path="/sys/bus/msm_subsys/devices" dev="sysfs" ino=17768 scontext=u:r:hal_sensors_default:s0 tcontext=u:object_r:sysfs_msm_subsys:s0 tclass=dir
# avc: granted { read } for comm="android.hardwar" name="devices" dev="sysfs" ino=17768 scontext=u:r:hal_sensors_default:s0 tcontext=u:object_r:sysfs_msm_subsys:s0 tclass=dir
# avc: denied { open } for comm="android.hardwar" path="/sys/devices/platform/soc/1c00000.qcom,ssc/subsys3/name" dev="sysfs" ino=49692 scontext=u:r:hal_sensors_default:s0 tcontext=u:object_r:sysfs_msm_subsys:s0 tclass=file

# avc: granted { getattr } for comm="android.hardwar" path="/sys/bus/esoc/devices" dev="sysfs" ino=28289 scontext=u:r:hal_sensors_default:s0 tcontext=u:object_r:sysfs_msm_subsys:s0 tclass=dir
allow hal_sensors_default sysfs_esoc:dir { getattr open read };

# avc: granted { module_request } for comm="android.hardwar" kmod="net-pf-42" scontext=u:r:hal_sensors_default:s0 tcontext=u:r:kernel:s0 tclass=system
# Follow crosshatch sepolicy and ignore:
dontaudit hal_sensors_default kernel:system module_request;

allow hal_sensors_default persist_file:dir search;
allow hal_sensors_default persist_sensors_file:dir search;
