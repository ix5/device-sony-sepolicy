allow hal_bluetooth_default bt_device:chr_file rw_file_perms;
allow hal_bluetooth_default serial_device:chr_file rw_file_perms;

allow hal_bluetooth_default bluetooth_vendor_data_file:dir create_dir_perms;
allow hal_bluetooth_default bluetooth_vendor_data_file:file create_file_perms;

allow hal_bluetooth_default kernel:system module_request;
allow hal_bluetooth_default self:socket create;

set_prop(hal_bluetooth_default, wc_prop)
set_prop(hal_bluetooth_default, bluetooth_prop)
set_prop(hal_bluetooth_default, vendor_bluetooth_prop)
# TODO: Check if ro.vendor.bt.* is enough

r_dir_file(hal_bluetooth_default, persist_file)
r_dir_file(hal_bluetooth_default, vendor_firmware_file)
r_dir_rw_file(hal_bluetooth_default, sysfs_bluetooth)
# TODO: Where does this come from?
# /mnt/vendor/ is mnt_vendor_file
# So it might be because it tries to search /mnt/vendor/persist/{bluetooth,*}
# /mnt/vendor/persist itself is labeled persist_file, everything inside it
# as well by default
# TODO: Still cannot reproduce on tone though
allow hal_bluetooth_default mnt_vendor_file:dir search;
userdebug_or_eng(`
  auditallow hal_bluetooth_default mnt_vendor_file:dir search;
')
