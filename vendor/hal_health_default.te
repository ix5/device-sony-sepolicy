# avc: granted { search } for comm="health@2.0-serv" name="spmi-0" dev="sysfs" ino=19103 scontext=u:r:hal_health_default:s0 tcontext=u:object_r:sysfs_msm_subsys:s0 tclass=dir
# avc: granted { search } for comm="android.hardwar" name="/" dev="mmcblk0p44" ino=2 scontext=u:r:hal_health_default:s0 tcontext=u:object_r:persist_file:s0 tclass=dir
allow hal_health_default { sysfs_msm_subsys persist_file }:dir search;
#allow hal_health_default persist_battery_file:file rw_file_perms;
#rw_dir_file(hal_health_default, persist_battery_file)
allow hal_health_default persist_battery_file:dir create_dir_perms;
allow hal_health_default persist_battery_file:file create_file_perms;

allow hal_health_default sysfs_batteryinfo:file r_file_perms;

#allow hal_health_default self:capability2 wake_alarm;

# to be used eventually for custom max charge levels
set_prop(hal_health_default, vendor_charge_prop)

#allow hal_health_default persist_battery_file:dir { add_name search write };
#allow hal_health_default persist_battery_file:file create;

# avc: granted { wake_alarm } for comm="health@2.0-serv" capability=35 scontext=u:r:hal_health_default:s0 tcontext=u:r:hal_health_default:s0 tclass=capability2
allow hal_health_default self:capability2 wake_alarm;

# from crosshatch
#get_prop(hal_health_default, vendor_shutdown_prop)
#set_prop(hal_health_default, vendor_shutdown_prop)

# Seems unused, we rather use persist_file:dir {search}
#allow hal_health_default mnt_vendor_file:dir search;
#auditallow hal_health_default mnt_vendor_file:dir search;
