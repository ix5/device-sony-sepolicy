# Policy for sensor daemon
type sscrpcd, domain;
type sscrpcd_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(sscrpcd)

allow sscrpcd self:capability {
    net_bind_service
};

allow sscrpcd persist_sensors_file:dir { open read search };
allow sscrpcd persist_sensors_file:file { getattr open read };
allow sscrpcd qdsp_device:chr_file { open read };
allow sscrpcd qdsp_device:chr_file ioctl;

# TODO: Make this more specific, convert (file_)contexts to use persist_sensors_file
# QUESTION: Which files? Cannot reproduce on tone
allow sscrpcd persist_file:dir search;
allow sscrpcd persist_file:lnk_file read;
allow sscrpcd qdsp_file:lnk_file read;
userdebug_or_eng(`
  auditallow sscrpcd persist_file:dir search;
  auditallow sscrpcd persist_file:lnk_file read;
  auditallow sscrpcd qdsp_file:lnk_file read;
')
