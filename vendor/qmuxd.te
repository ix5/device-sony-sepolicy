type qmuxd, domain;
type qmuxd_exec, exec_type, vendor_file_type, file_type;

net_domain(qmuxd)
init_daemon_domain(qmuxd)

# TODO: Is this necessary?
allow qmuxd kernel:system module_request;
userdebug_or_eng(`
  allow qmuxd kernel:system module_request;
')

allow qmuxd qmuxd_socket:dir w_dir_perms;
allow qmuxd qmuxd_socket:sock_file create_file_perms;

allow qmuxd smd_device:chr_file rw_file_perms;

# TODO: Check if this is necessary
allow qmuxd diag_device:chr_file { read write };
userdebug_or_eng(`
  auditallow qmuxd diag_device:chr_file { read write };
')

allow qmuxd self:socket create_socket_perms;
allowxperm qmuxd self:socket ioctl msm_sock_ipc_ioctls;

wakelock_use(qmuxd)

r_dir_file(qmuxd, sysfs_soc)
r_dir_rw_file(qmuxd, sysfs_msm_subsys)
