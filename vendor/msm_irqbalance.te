type msm_irqbalance, domain;
type msm_irqbalance_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(msm_irqbalance);

allow msm_irqbalance self:capability { setgid setuid };

# Allow to read and write files in /sys/devices/system/cpu/:
allow msm_irqbalance sysfs_devices_system_cpu:file rw_file_perms;

# Allow msm_irqbalance to search irq and set SMP affinity:
r_dir_rw_file(msm_irqbalance, proc_irq)

allow msm_irqbalance sysfs_irq:file r_file_perms;
allow msm_irqbalance proc_stat:file r_file_perms;
allow msm_irqbalance proc_interrupts:file r_file_perms;

# msm_irqbalance wants dac_override, but that is not a good idea
# and there is a neverallow that forbids this anyway
# TODO: fix msm_irqbalance to not request dac_override
# sepolicy guides say:
# Instead of granting them it is usually better to add the domain to
# a Unix group or change the permissions of a file.
#
# msm_irqbalance already gets setgid and setuid, that should be ample
# For now, just ignore it(that's bad as well, IRQs shouldn't be ignored under
# any circumstance!)
dontaudit msm_irqbalance self:capability dac_override;
