# Policy for /system/bin/pm-proxy
type per_proxy, domain;
type per_proxy_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(per_proxy)

allow per_proxy per_mgr_service:service_manager find;
# TODO: Remove auditallow statements
auditallow per_proxy per_mgr_service:service_manager find;
# TODO: Which denial?
allow per_proxy default_android_service:service_manager find;
auditallow per_proxy default_android_service:service_manager find;

# TODO(b/vndbinder): Remove once per_proxy uses vendor binder
typeattribute per_proxy binder_in_vendor_violators;
binder_use(per_proxy)
# instead of:
#allow per_proxy servicemanager:binder call;
allow per_proxy binder_device:chr_file rw_file_perms;

vndbinder_use(per_proxy)
binder_call(per_proxy, per_mgr)
r_dir_file(per_proxy, sysfs_msm_subsys)
